!function(e){var t={};function n(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(a,o,function(t){return e[t]}.bind(null,o));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){var e=[];return{getClassFactory:function(e){var t=arguments;return function(n){return void 0===n&&(n={}),{create:function(){return e.apply({context:n},t)}}}},getSingletonFactory:function(n){var a=arguments;return function(o){var r=void 0;return void 0===o&&(o={}),{getInstance:function(){return r||(r=t(o,n.className)),r||(r=n.apply({context:o},a),e.push({name:n.className,context:o,instance:r})),r}}}}};function t(t,n){var a=null;return e.some((function(e){return e.context===t&&e.name===n&&(a=e.instance,!0)})),a}}();t.default=a},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var a,o=n(3),r=(a=o)&&a.__esModule?a:{default:a};var i="undefined"!=typeof window&&window||e,s=i.voPlayer;s||(s=i.voPlayer={}),s.voAnalyticsPlugin=r.default,t.default=s}).call(this,n(2))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=u(n(4)),r=u(n(8)),i=u(n(9)),s=u(n(10)),l=u(n(11)),d=u(n(13));function u(e){return e&&e.__esModule?e:{default:e}}var c="server",p="verspective",y="agama",f="overlay",g="export",m=function(e,t){var n=void 0;switch(e){case c:n=(0,o.default)(t).getInstance();break;case p:n=(0,i.default)(t).getInstance();break;case y:n=(0,s.default)(t).getInstance();break;case f:n=(0,l.default)(t).getInstance();break;case g:n=(0,r.default)(t).getInstance()}return n},v=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.context=t,this.log=t.debug.log,this.analyticsHandler=(0,d.default)(t).getInstance(),this.reporterList=[]}return a(e,null,[{key:"voName",get:function(){return"voAnalyticsPlugin"}}]),a(e,[{key:"enableAnalyticsAgent",value:function(e,t,n){this.log("enableAnalyticsAgent");var a=m(f,this.context),o={analyticsHandler:this.analyticsHandler,version:t},r=a.enableAnalyticsAgent(o);o.getVideoStatistics=a?a.getVideoStatistics:void 0,o.isDashHandler=a?a.isDashHandler:void 0,o.getCurrentLiveLatency=n,o.isLiveStream=a?a.isLiveStream:void 0,r&&this.reporterList.push({type:f,reporter:a});var i=m(g,this.context);i.enableAnalyticsAgent(o)&&this.reporterList.push({type:g,reporter:i});for(var s=0;s<e.length;s++){var l=e[s],d=m(l.type,this.context);if(d&&l.options)l.options.analyticsHandler=this.analyticsHandler,l.options.version=t,c===l.type&&(l.options.reporter=a?a.reporter:void 0),p===l.type&&(l.options.getVideoStatistics=a?a.getVideoStatistics:void 0,l.options.isLiveStream=a?a.isLiveStream:void 0),y===l.type&&(l.options.getVideoStatistics=a?a.getVideoStatistics:void 0,l.options.isLiveStream=a?a.isLiveStream:void 0),d.enableAnalyticsAgent(l.options)&&this.reporterList.push({type:l.type,reporter:d})}return this.reporterList.length>0}},{key:"findReporterByType",value:function(e){for(var t=0;t<this.reporterList.length;t++)if(e===this.reporterList[t].type)return this.reporterList[t].reporter;return null}},{key:"setVideoSessionMetadata",value:function(e){for(var t=0;t<this.reporterList.length;t++){var n=this.reporterList[t].reporter;n&&n.setVideoSessionMetadata&&n.setVideoSessionMetadata(e)}}},{key:"getAnalyticsInfo",value:function(){var e=this.findReporterByType(f);return e&&e.getAnalyticsInfo?e.getAnalyticsInfo():null}},{key:"enableAnalyticsExport",value:function(e){var t=this.findReporterByType(g);t&&t.enableAnalyticsExport&&t.enableAnalyticsExport(e)}}]),e}();t.default=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,o=n(0),r=(a=o)&&a.__esModule?a:{default:a};function i(){var e,t=this.context;return e=n(5).default(t).getInstance(),{enableAnalyticsAgent:a("enableAnalyticsAgent"),setVideoSessionMetadata:a("setVideoSessionMetadata")};function a(t){return e?e[t]:function(){}}}i.className="voAnalyticsServerReporterWrapper",t.default=r.default.getSingletonFactory(i)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),o=i(n(6)),r=i(n(7));function i(e){return e&&e.__esModule?e:{default:e}}function s(){var e=this.context,t=(0,o.default)(e).getInstance(),n=void 0,a=void 0,i=void 0;return{enableAnalyticsAgent:function(o){if(a=o&&e.gkEngine.isAeEnable()){var s=(0,r.default)(e).getInstance();n=o.analyticsHandler;var l=void 0;return l="string"==typeof o.deviceId&&o.deviceId.match("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$")?o.deviceId:function(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}void 0===i&&(i=e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e());return t.log("[analyticsServer][reporter]uuid:"+i),i}(),n.configure({url:e.gkEngine.getAnalyticsURL(),uuid:l,key:e.gkEngine.getAnalyticsID(),reporter:o.reporter,analytics:s}),d=o.cuid,a&&n.set("metadata","cuid",d),!0}var d;n&&n.disable();return!1},setVideoSessionMetadata:function(e){if(!a||!e)return;!function(e){if(!e)return;for(var t=1;t<=n.nCD;t++)e["cd"+t]&&n.set("session","cd"+t,e["cd"+t]);for(var a=1;a<=n.nCM;a++)e["cm"+a]&&n.set("session","cm"+a,e["cm"+a])}(e.customData)}}}s.className="voAnalyticsServerReporter",t.default=a.default.getSingletonFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,o=n(0),r=(a=o)&&a.__esModule?a:{default:a};var i=1,s=2,l=3,d=4,u=5;function c(){var e=[],t=u,n=!0,a=!0,o=this.context.eventDelegate,r={fatal:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];p.apply(void 0,[i].concat(t))},error:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];p.apply(void 0,[s].concat(t))},warn:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];p.apply(void 0,[l].concat(t))},debug:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];p.apply(void 0,[u].concat(t))},info:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];p.apply(void 0,[d].concat(t))},log:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];p.apply(void 0,[u].concat(t))},doLog:p,getShowTimeStamp:function(){return n},setShowTimeStamp:function(e){n=e},getLogToConsole:function(){return a},setLogToConsole:function(e){a=e},setLogLevel:function(e){t=e},getLogLevel:function(){return t}};function c(e){return e&&e.bind?e.bind(window.console):window.console.log.bind(window.console)}return"undefined"!=typeof window&&window.console&&(e[i]=c(window.console.error),e[s]=c(window.console.error),e[l]=c(window.console.warn),e[d]=c(window.console.info),e[u]=c(window.console.debug)),r;function p(r){if(!(0==t||t<r)){var i="",s=null;n&&(s=new Date,i+="["+("0"+(s.getMonth()+1)).slice(-2)+"-"+("0"+s.getDate()).slice(-2)+" "+("0"+s.getHours()).slice(-2)+":"+("0"+s.getMinutes()).slice(-2)+":"+("0"+s.getSeconds()).slice(-2)+"."+("0"+s.getMilliseconds()).slice(-3)+"]"),i.length>0&&(i+=" ");for(var l=arguments.length,d=Array(l>1?l-1:0),u=1;u<l;u++)d[u-1]=arguments[u];Array.apply(null,d).forEach((function(e){i+=e+" "})),a&&e[r](i),o.onLogAdded({message:i,level:r})}}}c.className="voDebug",t.default=r.default.getSingletonFactory(c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,o=n(0),r=(a=o)&&a.__esModule?a:{default:a};function i(){var e=[],t=null,n=void 0,a=void 0,o={url:"http://ae53.visualon.info",abtestUrl:"",packetBufferSize:40,interval:3e4};return{configure:function(e,t){if(e.url){var n=e.url;"/"===n.slice(-1)&&(n=n.slice(0,-1)),o.url=n,o.abtestUrl=n+"/ab"}e.uuid&&t("metadata","uuid",e.uuid);e.key&&t("metadata","cid",e.key);e.reporter&&"function"==typeof e.reporter&&t("metadata","onPolling",e.reporter)},disable:function(){r(),n=null,a=null},reset:function(){t&&clearInterval(t);e=[]},setConfig:function(e){n=e.Error?e.Error:n,a=e.updatePacket?e.updatePacket:a},sendPacket:function(t,n){i(o.url,t,!1,(function(a){a&&function(t){e.length>=o.packetBufferSize&&e.shift();e.push({data:t,status:"pending"})}(t),n()}))},restartRepeatSending:r};function r(){clearInterval(t),t=setInterval((function(){a(),function(){for(var t=[],n=0;n<e.length;n++)"done"!==e[n].status&&t.push(e[n]);e=t;for(var a=function(t){var n=e[t],a=n.data;n.status="sending",i(o.url,a,!1,(function(e){n.status=e?"pending":"done"}))},r=0;r<e.length;r++)a(r)}()}),o.interval)}function i(e,t,a,o){if(window.XMLHttpRequest&&e){var r=new window.XMLHttpRequest;return"withCredentials"in r&&(r.open("POST",e,!0),r.setRequestHeader("Content-Type","application/json"),r.onload=function(){200===this.status?o(null,this.responseText):o(new n("sending packet is failed"))},r.timeout=3e3,r.ontimeout=function(){o(new n("connection timeout"))},r.onerror=function(){o(new n("connection error"))},r.send(t),r=null,!0)}return!1}}i.className="voAnalytics",t.default=r.default.getSingletonFactory(i)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,o=n(0),r=(a=o)&&a.__esModule?a:{default:a};function i(){this.context;return{enableAnalyticsAgent:e("enableAnalyticsAgent"),setVideoSessionMetadata:e("setVideoSessionMetadata"),enableAnalyticsExport:e("enableAnalyticsExport")};function e(e){return function(){}}}i.className="voAnalyticsExportReporterWrapper",t.default=r.default.getSingletonFactory(i)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,o=n(0),r=(a=o)&&a.__esModule?a:{default:a};function i(){this.context;return{enableAnalyticsAgent:e("enableAnalyticsAgent"),setVideoSessionMetadata:e("setVideoSessionMetadata")};function e(e){return function(){}}}i.className="voVerspectiveReporterWrapper",t.default=r.default.getSingletonFactory(i)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,o=n(0),r=(a=o)&&a.__esModule?a:{default:a};function i(){this.context;return{enableAnalyticsAgent:e("enableAnalyticsAgent"),setVideoSessionMetadata:e("setVideoSessionMetadata")};function e(e){return function(){}}}i.className="voAgamaReporterWrapper",t.default=r.default.getSingletonFactory(i)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _factory=__webpack_require__(0),_factory2=_interopRequireDefault(_factory),_analyticsError=__webpack_require__(12),_analyticsError2=_interopRequireDefault(_analyticsError);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function voAnalyticsOverlay(){var context=this.context,commonUtil=context.commonUtil,voInternalEvents=context.voInternalEvents,eventBus=context.eventBus,debug=context.debug,voErrorCode=context.voErrorCode,analyticsErrorObj=(0,_analyticsError2.default)(voErrorCode),analytics=void 0,enableAnalytics=void 0,upBA=0,upBALast=0,downBA=0,downBALast=0,playingBitrate=0,streamingBitrate=0,streamingFps=0,droppedFramesCount=0,droppedFramesCountLast=0,totalFramesCount=0,totalFramesCountLast=0,isIE=commonUtil.isIE(),totalVideoFramesForIE=0,droppedVideoFramesForIE=0,totalDownloadBytes=0,totalDownloadBytesLast=0,totalDroppedBytes=0,totalDroppedBytesLast=0,totalDownloadTime=0,totalDownloadTimeLast=0,element=void 0,manifest=void 0,currentStatus="",CodecErrorCount=0,os=void 0,osVersion=void 0,videoLinkUrl=void 0,videoAdaptation=null,bandwidth=0,playerVersion=void 0,resolution={},handlerType=void 0,isLive=!1,eventList={},instance={enableAnalyticsAgent:enableAnalyticsAgent,setVideoSessionMetadata:setVideoSessionMetadata,getAnalyticsInfo:getAnalyticsInfo,getVideoStatistics:getVideoStatistics,isLiveStream:isLiveStream,isDashHandler:isDashHandler,reporter:reporter};return instance;function register(e,t){eventList[e]&&eventList[e].callback===t||(eventBus.on(e,t,this),e!==voInternalEvents.VO_INTERNAL_ERROR&&e!==voInternalEvents.VO_INTERNAL_STREAM_ENDED&&(eventList[e]={callback:t}))}function unregister(e,t){eventList[e].callback===t&&(eventBus.off(e,t,this),eventList[e]={})}function unregisterAll(){for(var e in eventList)eventList[e]&&unregister(e,eventList[e].callback);eventList={}}function registerInitEvents(){register(voInternalEvents.VO_INTERNAL_ERROR,voInternalError),register(voInternalEvents.VO_INTERNAL_STREAM_ENDED,voInternalStreamEnded)}function registerEvents(){register(voInternalEvents.VO_INTERNAL_MEDIA_PLAYING,onInternalMediaPlaying),register(voInternalEvents.VO_INTERNAL_MEDIA_WAITING,onInternalMediaWaiting),register(voInternalEvents.VO_INTERNAL_MEDIA_SEEKING,onInternalMediaSeeking),register(voInternalEvents.VO_INTERNAL_MEDIA_PAUSED,onInternalMediaPaused),register(voInternalEvents.VO_INTERNAL_QUALITY_LEVEL_CHANGED,onInternalQualityLevelChanged),register(voInternalEvents.VO_INTERNAL_REPORT_MANIFEST_INFO,onInternalReportManifestInfo),register(voInternalEvents.VO_INTERNAL_REPORT_DOWNLOADED_INFO,onInternalReportDownloadedInfo),register(voInternalEvents.VO_INTERNAL_REPORT_DROPPED_BYTES,onInternalReportDroppedBytes),register(voInternalEvents.VO_INTERNAL_REPORT_STREAM_BITRATE,onInternalReportStreamBitrate),register(voInternalEvents.VO_INTERNAL_REPORT_DRM_TYPE,onInternalReportDrmType),isIE&&element&&element.addEventListener&&element.addEventListener("seeking",onSeeking)}function onSeeking(){var e=getPlaybackQuality();e&&(totalVideoFramesForIE+=e.totalVideoFrames,droppedVideoFramesForIE+=e.droppedVideoFrames)}function unRegisterEvents(){unregisterAll(),isIE&&element&&element.removeEventListener&&element.removeEventListener("seeking",onSeeking)}function enableAnalyticsAgent(e){if(!e)return!1;if(enableAnalytics=!0){analytics=e.analyticsHandler,playerVersion=e.version;var t=commonUtil.getOS();return os=t.os,osVersion=t.osVersion,analytics.set("metadata","os",os),analytics.set("metadata","osv",osVersion),analytics.set("metadata","ver","html5"),analytics.set("metadata","pv",e.version),analytics.set("metadata","model",commonUtil.getBrowserName().browser+"-"+commonUtil.getBrowserName().version),registerInitEvents(),!0}return analytics&&analytics.disable(),!1}function reporter(){analytics&&(analytics.set("session","vip",getVideoLinkUrl()),analytics.set("session","bdn",getDownloadBytesDelta()),analytics.set("session","bdr",getDroppedBytesDelta()),analytics.set("session","tdt",getDownloadTimeDelta()),analytics.set("session","pb",getPlayingBitrate()),analytics.set("session","sb",getStreamingBitrate()),analytics.set("session","bau",getUpBADelta()),analytics.set("session","bad",getDownBADelta()),analytics.set("session","afps",getPlayingFps()),void 0!==streamingFps&&analytics.set("session","sfps",getStreamingFps()),analytics.set("session","fdc",getDroppedFramesCountDelta()),analytics.set("session","tfc",getTotalFramesCountDelta()),analytics.set("session","cec",getCodecErrorCount()),updateData())}function setVideoSessionMetadata(e){if(enableAnalytics){if(!e)return;var t=e.drmInfo;resetData(),currentStatus="opening",videoLinkUrl=e.uri,analytics.set("session","state","opening"),debug.log("[analytics] report to analytics: opening"),analytics.set("session","url",e.uri),analytics.set("session","drm",t.drmType),analytics.set("session","laurl",t.laUrl),analytics.set("session","drmcd",t.customData),debug.log("[analytics] url: "+e.uri+", drmType: "+t.drmType+", laUrl: "+t.laUrl+", customData: "+t.customData),element=e.element,handlerType=e.handlerType,registerEvents()}}function onInternalReportDrmType(e){if(enableAnalytics&&e){var t=e.drmType;analytics.set("session","drm",t),debug.log("[analytics] drmType:"+t)}}function onInternalMediaPlaying(){if(enableAnalytics){if("playing"===currentStatus)return;currentStatus="playing",analytics.set("session","state","playing"),debug.log("[analytics] report to analytics: playing")}}function onInternalMediaWaiting(){if(enableAnalytics){if("buffering"===currentStatus||"paused"===currentStatus)return;currentStatus="buffering",analytics.set("session","state","buffering"),debug.log("[analytics] report to analytics: buffering")}}function onInternalMediaSeeking(){if(enableAnalytics){if("seeking"===currentStatus)return;currentStatus="seeking",analytics.set("session","state","seeking"),debug.log("[analytics] report to analytics: seeking")}}function onInternalMediaPaused(){if(enableAnalytics){if("paused"===currentStatus)return;currentStatus="paused",analytics.set("session","state","paused"),debug.log("[analytics] report to analytics: paused")}}function voInternalStreamEnded(){if(enableAnalytics){if("stopped"===currentStatus)return;currentStatus="stopped",debug.log("[analytics] report to analytics: stopped"),analytics.set("session","state","stopped"),unRegisterEvents()}}function onInternalQualityLevelChanged(data){if(enableAnalytics&&data&&isFinite(data.newBandwidth)&&data.oldBandwidth!==data.newBandwidth){if(videoAdaptation&&"video"!==data.mediaType)return;if(isFinite(data.oldBandwidth)&&isFinite(data.newBandwidth)&&(data.oldBandwidth<data.newBandwidth?(++upBA,debug.log("[analytics] BA old:"+data.oldBandwidth+",new:"+data.newBandwidth+",upBA:"+upBA)):(++downBA,debug.log("[analytics] BA old:"+data.oldBandwidth+",new:"+data.newBandwidth+",downBA:"+downBA))),resolution.width=data.width,resolution.height=data.height,playingBitrate=data.newBandwidth||0,streamingFps=data.frameRate||0,debug.log("[analytics] playingBitrate:"+playingBitrate),videoAdaptation)for(var i=0;i<videoAdaptation.Representation_asArray.length;i++){var representation=videoAdaptation.Representation_asArray[i];if(representation.bandwidth==playingBitrate){streamingFps=eval(representation.frameRate)||0,debug.log("[analytics] streamingFps:"+streamingFps);break}}streamingFps=parseFloat(streamingFps.toFixed(2))}}function onInternalReportStreamBitrate(e){enableAnalytics&&e&&(streamingBitrate=e.Bitrate)}function onInternalReportDownloadedInfo(e){enableAnalytics&&e&&e.downloadBytes&&e.downloadTime&&(totalDownloadBytes+=e.downloadBytes,totalDownloadTime+=e.downloadTime,bandwidth=Math.round(8*e.downloadBytes/e.downloadTime),debug.log("[analytics] totalDownloadBytes:"+totalDownloadBytes+",totalDownloadTime:"+totalDownloadTime))}function onInternalReportDroppedBytes(e){enableAnalytics&&e&&(totalDroppedBytes+=e.droppedBytes?e.droppedBytes:0,debug.log("[analytics] DroppedBytes:"+totalDroppedBytes))}function voInternalError(e){if(enableAnalytics&&e){var t=e.errorId;if(voErrorCode.VO_OSMP_SRC_ERR_CONTENT_PARSE_FAIL===t&&0>=e.message.indexOf("MEDIA_ERR_DECODE"))return CodecErrorCount++,void debug.log("[analytics] CodecErrorCount: "+CodecErrorCount);var n="";switch(t){case voErrorCode.VO_OSMP_DRM_ERR_BROWSER_UNSUPPORT:case voErrorCode.VO_OSMP_DRM_ERR_KEY_FAIL:case voErrorCode.VO_OSMP_DRM_ERR_LICENSE_REQUEST_FAIL:case voErrorCode.VO_OSMP_DRM_ERR_SELECT_KEY_SYSTEM_FAIL:case voErrorCode.VO_OSMP_DRM_ERR_KEY_SESSION_FAIL:case voErrorCode.VO_OSMP_DRM_ERR_DECRYPT_FAIL:n="drm_err";break;case voErrorCode.VO_OSMP_SRC_ERR_MANIFEST_DOWNLOAD_FAIL:case voErrorCode.VO_OSMP_SRC_ERR_CONTENT_DOWNLOAD_FAIL:n="http_err";break;default:n="other_err"}handleErrorByType(analyticsErrorObj[t],n)}}function handleErrorByType(e,t){analytics.set("session",t,e)}function getUpBADelta(){var e=upBA-upBALast;return debug.log("[analytics] upBADelta:"+e+",upBA:"+upBA),e}function getDownBADelta(){var e=downBA-downBALast;return debug.log("[analytics] downBADelta:"+e+",downBA:"+downBA),e}function getPlayingBitrate(){return debug.log("[analytics] playingBitrate:"+playingBitrate),playingBitrate}function getStreamingFps(){return debug.log("[analytics] streamingFps:"+streamingFps),streamingFps}function getStreamingBitrate(){return debug.log("[analytics] streamingBitrate:"+streamingBitrate),streamingBitrate}function getPlayingFps(){var e=getPlaybackQuality();if(e){var t=e.totalVideoFrames-e.droppedVideoFrames,n=getSessionMetrics(),a=n.tpt?t/(n.tpt/1e3):0;return debug.log("[analytics] playingFps:"+a),a}return 0}function getDroppedFramesCountDelta(){var e=getDroppedFramesCount()?droppedFramesCount-droppedFramesCountLast:0;return debug.log("[analytics] droppedFramesCountDelta:"+e+",droppedFramesCount:"+droppedFramesCount),e>=0?e:0}function getTotalFramesCountDelta(){var e=getTotalFramesCount()?totalFramesCount-totalFramesCountLast:0;return debug.log("[analytics] totalFramesCountDelta:"+e+",totalFramesCount:"+totalFramesCount),e>=0?e:0}function getDroppedFramesCount(){if("stopped"===currentStatus)return debug.log("[analytics] droppedFramesCount:"+droppedFramesCountLast),0;var e=getPlaybackQuality();return e&&(droppedFramesCount=e.droppedVideoFrames),isIE&&(droppedFramesCount=droppedFramesCountLast>(droppedFramesCount+=droppedVideoFramesForIE)?droppedFramesCountLast:droppedFramesCount),droppedFramesCount}function getTotalFramesCount(){if("stopped"===currentStatus)return debug.log("[analytics] totalFramesCount:"+totalFramesCountLast),0;var e=getPlaybackQuality();return e&&(totalFramesCount=e.totalVideoFrames),isIE&&(totalFramesCount=totalFramesCountLast>(totalFramesCount+=totalVideoFramesForIE)?totalFramesCountLast:totalFramesCount),totalFramesCount}function onInternalReportManifestInfo(e){if(enableAnalytics&&e)if(!isDashHandler()||commonUtil.isChromecastCAF())e.mediaDuration>0&&!e.live?analytics.set("session","length",1e3*e.mediaDuration):analytics.set("session","length",0),isLive=e.live;else{if(!(manifest=e.data))return;if(isLive="static"!==manifest.type,manifest.mediaPresentationDuration&&(analytics.set("session","length",1e3*manifest.mediaPresentationDuration),debug.log("[analytics] duration:"+manifest.mediaPresentationDuration+"s")),manifest&&manifest.Period_asArray)for(var t=0;t<manifest.Period_asArray.length;t++){var n=manifest.Period_asArray[t].AdaptationSet_asArray;if(n)for(var a=0;a<n.length;a++){var o=n[a];if(o.mimeType&&-1!==o.mimeType.indexOf("video")||o.Representation_asArray[0].mimeType&&-1!==o.Representation_asArray[0].mimeType.indexOf("video")){videoAdaptation=o;break}}}}}function getPlaybackQuality(){if(!element)return null;var e="webkitDroppedFrameCount"in element&&"webkitDecodedFrameCount"in element,t=null;return"getVideoPlaybackQuality"in element?t=element.getVideoPlaybackQuality():e&&(t={droppedVideoFrames:element.webkitDroppedFrameCount,totalVideoFrames:element.webkitDecodedFrameCount}),t}function getVideoLinkUrl(){var e=videoLinkUrl.match(/https?:\/\/([^\/]+)\//i);return e?(debug.log("[analytics] videoLinkUrl:"+e[1]),e[1]):""}function getDownloadBytesDelta(){var e=totalDownloadBytes-totalDownloadBytesLast;return debug.log("[analytics] totalDownloadBytesDelta:"+e+",totalDownloadBytes:"+totalDownloadBytes),e}function getDownloadTimeDelta(){var e=totalDownloadTime-totalDownloadTimeLast;return debug.log("[analytics] totalDownloadTimeDelta:"+e+",totalDownloadTime:"+totalDownloadTime),e}function getDroppedBytesDelta(){var e=totalDroppedBytes-totalDroppedBytesLast;return debug.log("[analytics] totalDroppedBytesDelta:"+e+",totalDroppedBytes:"+totalDroppedBytes),e}function getCodecErrorCount(){return debug.log("[analytics] report CodecErrorCount:"+CodecErrorCount),CodecErrorCount}function updateData(){debug.log("[analytics] update data"),upBALast=upBA,downBALast=downBA,droppedFramesCountLast=droppedFramesCount,totalFramesCountLast=totalFramesCount,totalDownloadBytesLast=totalDownloadBytes,totalDroppedBytesLast=totalDroppedBytes,totalDownloadTimeLast=totalDownloadTime}function resetData(){debug.log("[analytics]reset data"),upBA=0,upBALast=0,downBA=0,downBALast=0,droppedFramesCount=0,droppedFramesCountLast=0,droppedVideoFramesForIE=0,totalFramesCount=0,totalFramesCountLast=0,totalVideoFramesForIE=0,totalDownloadBytes=0,totalDownloadBytesLast=0,totalDroppedBytes=0,totalDroppedBytesLast=0,totalDownloadTime=0,totalDownloadTimeLast=0,playingBitrate=0,streamingBitrate=0,streamingFps=0,CodecErrorCount=0,currentStatus="",videoAdaptation=null,element=null,manifest=null,videoLinkUrl=null,bandwidth=0,resolution={},handlerType=null,isLive=!1}function getAnalyticsInfo(){if(!enableAnalytics||!element)return null;var e=getSessionMetrics(),t=!(isDashHandler()||isHlsHandler()),n=commonUtil.isSafari()&&(isHlsHandler()||t),a=t||n;return{startupTime:(e.vst?e.vst:0)+" msec",playTime:(e.tpt?e.tpt:0)+" msec",bufferingTime:(e.tbt?e.tbt:0)+" msec",streamingFps:a?"NA":parseFloat(getPlayingFps().toFixed(2))+" fps",aveBandwidth:a?"NA":(totalDownloadTime?Math.round(8*totalDownloadBytes/totalDownloadTime):0)+" kbps",bandwidth:a?"NA":(bandwidth||0)+"kbps",playlistBitrate:a?"NA":(playingBitrate?Math.round(playingBitrate/1e3):0)+" kbps",adaptations:a?"NA":upBA+downBA,totalFrames:n?"NA":getTotalFramesCount(),droppedFrames:n?"NA":getDroppedFramesCount(),downloadTime:a?"NA":(totalDownloadTime||0)+" msec",downloadBytes:a?"NA":totalDownloadBytes,droppedBytes:a?"NA":totalDroppedBytes,videoLinkURL:videoLinkUrl,playerVersion:playerVersion,resolution:resolution&&resolution.width&&resolution.height?resolution.width+" x "+resolution.height:element.videoWidth&&element.videoHeight?element.videoWidth+" x "+element.videoHeight:"NA"}}function getSessionMetrics(){var e=analytics.getSession();return e.open_ready&&analytics.updateState({ts:Date.now(),e:e.prevState.e}),(e=analytics.getSession()).metrics}function getVideoStatistics(){return{resolution:resolution,playbackQuality:getPlaybackQuality,playlistBitrate:playingBitrate?Math.round(playingBitrate/1e3):0,streamingBitrate:streamingBitrate,streamingFps:streamingFps,playingFps:parseFloat(getPlayingFps().toFixed(2))}}function isLiveStream(){return isLive}function isDashHandler(){return"application/dash+xml"===handlerType}function isHlsHandler(){return"application/x-mpegurl"===handlerType}}voAnalyticsOverlay.className="voAnalyticsOverlay",exports.default=_factory2.default.getSingletonFactory(voAnalyticsOverlay)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){var t={};return t[e.VO_OSMP_DRM_ERR_KEY_FAIL]="key_err",t[e.VO_OSMP_DRM_ERR_KEY_SESSION_FAIL]="key_sessio",t[e.VO_OSMP_DRM_ERR_LICENSE_REQUEST_FAIL]="licRq",t[e.VO_OSMP_DRM_ERR_SELECT_KEY_SYSTEM_FAIL]="slKySy",t[e.VO_OSMP_DRM_ERR_DECRYPT_FAIL]="dec",t[e.VO_OSMP_DRM_ERR_BROWSER_UNSUPPORT]="drm_unsp",t[e.VO_OSMP_SRC_ERR_MANIFEST_DOWNLOAD_FAIL]="mnf_dn",t[e.VO_OSMP_SRC_ERR_CONTENT_DOWNLOAD_FAIL]="cont_dn",t[e.VO_OSMP_SRC_ERR_FORMAT_UNSUPPORT]="fmt_bad",t[e.VO_OSMP_SRC_ERR_CODEC_UNSUPPORT]="cod_unsp",t[e.VO_OSMP_SRC_ERR_BROWSER_UNSUPPORT_MSE]="mse_unsp",t[e.VO_OSMP_SRC_ERR_MANIFEST_PARSE_FAIL]="manifestPa",t[e.VO_OSMP_SRC_ERR_CONTENT_PARSE_FAIL]="con_par",t[e.VO_OSMP_SRC_ERR_TEXT_TRACK_PARSE_FAIL]="cc",t[e.VO_OSMP_SRC_ERR_SOURCE_BUFFER_ERROR]="sour_buf",t[e.VO_OSMP_SRC_ERR_OUTMEMORY]="out_of_mem",t[e.VO_OSMP_SRC_ERR_UNKNOWN]="unk_err",t[e.VO_OSMP_LICENSE_FAIL]="lcs_fal",t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=n(0),i=(a=r)&&a.__esModule?a:{default:a};function s(){for(var e=0,t=Date.now().toString(16),n=void 0,a={metadata:{model:{type:"string",key:"dm",sizeLimit:32},os:{type:"string",key:"os",sizeLimit:32},osv:{type:"string",key:"osv",sizeLimit:32},ver:{type:"string",key:"av",sizeLimit:32},pv:{type:"string",key:"pv",sizeLimit:32},cuid:{type:"string",key:"cuid",sizeLimit:64},uuid:{type:"string",key:"tid",sizeLimit:64},cid:{type:"string",key:"cid",sizeLimit:16},onPolling:{type:"function",key:"onPolling"}},session:{pt:{type:"string",key:"pt",sizeLimit:16},vdt:{type:"string",key:"vdt",sizeLimit:16},drm:{type:"string",key:"drm",sizeLimit:32},laurl:{type:"string",key:"laurl",sizeLimit:2048},drmcd:{type:"string",key:"drmcd",sizeLimit:2048},name:{type:"string",key:"vn",sizeLimit:50},url:{type:"string",key:"uri",sizeLimit:2048},cdn:{type:"string",key:"cdn",sizeLimit:64},vip:{type:"string",key:"vip",sizeLimit:32},ct:{type:"string",key:"ct",sizeLimit:16},length:{type:"number",key:"len"},pb:{type:"number",key:"pb"},sb:{type:"number",key:"sb"},bau:{type:"number",key:"bau"},bad:{type:"number",key:"bad"},afps:{type:"number",key:"afps"},sfps:{type:"number",key:"sfps"},fdc:{type:"number",key:"fdc"},tfc:{type:"number",key:"tfc"},wrt:{type:"number",key:"wrt"},bdn:{type:"number",key:"bdn"},bdr:{type:"number",key:"bdr"},tdt:{type:"number",key:"tdt"},tdr:{type:"number",key:"tdr"},cec:{type:"number",key:"cec"},cu:{type:"number",key:"cu"},mu:{type:"number",key:"mu"},http_err:{specialHandle:"errorEvent",type:"string",key:"hte",cnt:"hec",sizeLimit:256,numLimit:5},drm_err:{specialHandle:"errorEvent",type:"string",key:"dre",cnt:"dec",sizeLimit:256,numLimit:5},other_err:{specialHandle:"errorEvent",type:"string",key:"ote",cnt:"oec",sizeLimit:256,numLimit:5},state:{specialHandle:"playerEvent",sizeLimit:40,numLimit:15,opening:"ope",idle:"idl",playing:"pla",buffering:"buf",seeking:"sek",paused:"pau",stopped:"idl",suspend:"sus"}}},r={dm:!0,os:!0,osv:!0,av:!0,pv:!0,cuid:!0,tid:!0,cid:!0,onPolling:!0},i={pt:!0,vdt:!0,drm:!0,laurl:!0,drmcd:!0,title:!0,uri:!0,len:!0},s=1;s<=4;s++)i["cm"+s]=!0,a.session["cm"+s]={type:"number",key:"cm"+s};for(var l=1;l<=4;l++)i["cd"+l]=!0,a.session["cd"+l]={type:"string",key:"cd"+l};var d,u,c=(d={states:[],prevState:{ts:Date.now(),e:"idle"},metrics:{pn:-1},open_ready:!1,timestamp:0},{lastEvent:"idl",stateChanged:!1,session:d,packet:u={},resetForNewSession:function(){for(var e in u=u||{})r[e]||delete u[e];d.states=[],d.prevState={ts:Date.now(),e:"idle"},d.metrics={pn:-1},d.open_ready=!1,d.timestamp=0,"idl",n&&n.restartRepeatSending()},reset:function(){n&&n.reset()}});return c.resetForNewSession(),{set:p,configure:function(e){if(!e)return;(n=e.analytics)&&(n.setConfig({Error:m,updatePacket:f}),n.configure(e,p))},disable:function(){n&&n.disable()},getSession:function(){return c.session},updateState:y,nCD:4,nCM:4};function p(){var e=arguments;if(e.length<=2||e.length>=5)throw m("Wrong argument number. Arguments: "+e.toString());var t=c.packet,n=e[0],r=e[1],i=e[2],s=e[3]||Date.now();if(null==i||null==n||null==r)throw m("Wrong arguments. Arguments: "+e.toString());var l=a[n][r];if("playerEvent"===l.specialHandle)y({ts:s,e:i},l);else if("errorEvent"===l.specialHandle){null!==l.sizeLimit&&void 0!==l.sizeLimit&&"string"===l.type&&(i=i.slice(0,l.sizeLimit)),t.pe=t.pe||{ts:c.session.timestamp,le:c.lastEvent,e:[],en:{nor:0,hte:0,dre:0,ote:0}};var d=l.key;t[l.cnt]=(t[l.cnt]||0)+1,t.pe.en[d]<l.numLimit&&(t.pe.e.push({t:d,o:s-t.pe.ts,e:i}),t.pe.en[l.key]++)}else if(null===l.type||void 0===l.type){if("object"!==(void 0===i?"undefined":o(i)))throw m('Wrong value type "'+i+'" for metric '+r);for(var u in i){if(o(i[u])!==l[u].type)throw m('Wrong value type "'+i[u]+'" for metric: '+r);null!==l[u].key&&void 0!==l[u].key&&(t[l[u].key]=i[u])}}else{if(null!==l.sizeLimit&&void 0!==l.sizeLimit&&"string"===l.type&&(i=i.slice(0,l.sizeLimit)),(void 0===i?"undefined":o(i))!==l.type)throw m('Wrong value type "'+i+'" for metric: '+r);null!==l.key&&void 0!==l.key&&(t[l.key]=i)}}function y(t,n){var a=t.e,o=t.ts,r=c.session.prevState.e,i=c.session.prevState.ts,s=!n||n[(""+a).toLowerCase()];if(s&&("idle"!==r||"opening"===a)&&(c.session.open_ready||"buffering"!==a)){"opening"===a&&(c.resetForNewSession(),c.session.timestamp=o,e++,c.lastEvent="ope");var l=c.session.metrics,d=c.packet;if(d.pe=d.pe||{ts:c.session.timestamp,le:c.lastEvent,e:[],en:{nor:0,hte:0,dre:0,ote:0}},"opening"!==a)if(n&&d.pe.en.nor<n.numLimit)d.pe.e.push({t:s,o:o-d.pe.ts}),d.pe.en.nor++;else if(n&&d.pe.en.nor===n.numLimit)for(var u=d.pe.e.length-1;u>=0;u--){var p=d.pe.e[u].t;if(p===n.seeking||p===n.buffering||p===n.playing||p===n.paused){d.pe.e.splice(u,1),d.pe.e.push({t:s,o:o-d.pe.ts});break}}if(c.session.states.push(t),c.session.prevState=t,n&&(c.lastEvent=s),a!==r&&(c.stateChanged=!0),"buffering"===r&&(l.tbt=(l.tbt||0)+o-i),"playing"===r&&(l.tpt=(l.tpt||0)+o-i,l.wt=(l.wt||0)+o-i),"seeking"===r&&(l.tst=(l.tst||0)+o-i),"playing"!==a||c.session.open_ready||(c.session.metrics.pn=1,c.session.open_ready=!0,l.vst=o-c.session.timestamp),"stopped"===a&&"stopped"!==r){if(c.session.open_ready)c.session.metrics.pn=-2;else for(var y=c.session.states,f=0;f<y.length;f++)if("opening"===y[f].e){l.vst=o-y[f].ts;break}g(c.packet,(function(){})),c.resetForNewSession(),c.reset()}}}function f(){c.session.open_ready&&(y({ts:Date.now(),e:c.session.prevState.e}),g(c.packet,(function(){})),c.session.metrics.pn++)}function g(a,o){o=o||function(){};var s=function(n){for(var a in c.session.metrics)n[a]=c.session.metrics[a];n.pe=n.pe||{ts:c.session.timestamp,le:c.lastEvent,e:[]},n.ts=n.pe.ts,n.asid=t,n.usid=e,n.v=2;var o=n.onPolling;o&&o();delete n.onPolling,delete n.pe.en,n.pe=JSON.stringify(n.pe),function(){for(var e=0,t=1;t<=4;t++){var n=c.packet["cd"+t];null!=n&&(e>100?delete c.packet["cd"+t]:(e+=n.length)>100&&(c.packet["cd"+t]=n.slice(0,100-e)))}}();var s=JSON.stringify(n);return function(e){for(var t in e)i[t]||r[t]||delete e[t];c.stateChanged=!1,e.pe=null,c.session.metrics.wt=0,c.session.timestamp=Date.now()}(n),n.onPolling=o,s}(a);o(),n&&n.sendPacket(s,o)}function m(e){return"[Error] "+e}}s.className="voAnalyticsHandler",t.default=i.default.getSingletonFactory(s)}]);